(function(d,x){typeof exports=="object"&&typeof module<"u"?module.exports=x():typeof define=="function"&&define.amd?define(x):(d=typeof globalThis<"u"?globalThis:d||self,d["quill-image-resizor"]=x())})(this,function(){"use strict";var De;var d=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function x(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Le(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var H=Le;function Ue(e){return e}var N=Ue,ze=H,K=Math.max;function Fe(e,t,r){return t=K(t===void 0?e.length-1:t,0),function(){for(var i=arguments,s=-1,a=K(i.length-t,0),n=Array(a);++s<a;)n[s]=i[t+s];s=-1;for(var o=Array(t+1);++s<t;)o[s]=i[s];return o[t]=r(n),ze(e,this,o)}}var Ge=Fe;function Re(e){return function(){return e}}var qe=Re,ke=typeof d=="object"&&d&&d.Object===Object&&d,W=ke,He=W,Ne=typeof self=="object"&&self&&self.Object===Object&&self,Ke=He||Ne||Function("return this")(),v=Ke,We=v,Xe=We.Symbol,X=Xe,V=X,Q=Object.prototype,Ve=Q.hasOwnProperty,Qe=Q.toString,O=V?V.toStringTag:void 0;function Je(e){var t=Ve.call(e,O),r=e[O];try{e[O]=void 0;var i=!0}catch{}var s=Qe.call(e);return i&&(t?e[O]=r:delete e[O]),s}var Ye=Je,Ze=Object.prototype,et=Ze.toString;function tt(e){return et.call(e)}var rt=tt,J=X,it=Ye,at=rt,st="[object Null]",nt="[object Undefined]",Y=J?J.toStringTag:void 0;function ot(e){return e==null?e===void 0?nt:st:Y&&Y in Object(e)?it(e):at(e)}var w=ot;function lt(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var p=lt,ht=w,ct=p,ut="[object AsyncFunction]",dt="[object Function]",pt="[object GeneratorFunction]",ft="[object Proxy]";function vt(e){if(!ct(e))return!1;var t=ht(e);return t==dt||t==pt||t==ut||t==ft}var L=vt,gt=v,yt=gt["__core-js_shared__"],bt=yt,U=bt,Z=function(){var e=/[^.]+$/.exec(U&&U.keys&&U.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function _t(e){return!!Z&&Z in e}var $t=_t,mt=Function.prototype,xt=mt.toString;function Ot(e){if(e!=null){try{return xt.call(e)}catch{}try{return e+""}catch{}}return""}var Ct=Ot,St=L,wt=$t,jt=p,Tt=Ct,At=/[\\^$.*+?()[\]{}|]/g,It=/^\[object .+?Constructor\]$/,Mt=Function.prototype,Pt=Object.prototype,Et=Mt.toString,Dt=Pt.hasOwnProperty,Bt=RegExp("^"+Et.call(Dt).replace(At,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Lt(e){if(!jt(e)||wt(e))return!1;var t=St(e)?Bt:It;return t.test(Tt(e))}var Ut=Lt;function zt(e,t){return e==null?void 0:e[t]}var Ft=zt,Gt=Ut,Rt=Ft;function qt(e,t){var r=Rt(e,t);return Gt(r)?r:void 0}var z=qt,kt=z,Ht=function(){try{var e=kt(Object,"defineProperty");return e({},"",{}),e}catch{}}(),ee=Ht,Nt=qe,te=ee,Kt=N,Wt=te?function(e,t){return te(e,"toString",{configurable:!0,enumerable:!1,value:Nt(t),writable:!0})}:Kt,Xt=Wt,Vt=800,Qt=16,Jt=Date.now;function Yt(e){var t=0,r=0;return function(){var i=Jt(),s=Qt-(i-r);if(r=i,s>0){if(++t>=Vt)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var Zt=Yt,er=Xt,tr=Zt,rr=tr(er),ir=rr,ar=N,sr=Ge,nr=ir;function or(e,t){return nr(sr(e,t,ar),e+"")}var re=or;function lr(){this.__data__=[],this.size=0}var hr=lr;function cr(e,t){return e===t||e!==e&&t!==t}var j=cr,ur=j;function dr(e,t){for(var r=e.length;r--;)if(ur(e[r][0],t))return r;return-1}var T=dr,pr=T,fr=Array.prototype,vr=fr.splice;function gr(e){var t=this.__data__,r=pr(t,e);if(r<0)return!1;var i=t.length-1;return r==i?t.pop():vr.call(t,r,1),--this.size,!0}var yr=gr,br=T;function _r(e){var t=this.__data__,r=br(t,e);return r<0?void 0:t[r][1]}var $r=_r,mr=T;function xr(e){return mr(this.__data__,e)>-1}var Or=xr,Cr=T;function Sr(e,t){var r=this.__data__,i=Cr(r,e);return i<0?(++this.size,r.push([e,t])):r[i][1]=t,this}var wr=Sr,jr=hr,Tr=yr,Ar=$r,Ir=Or,Mr=wr;function g(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}g.prototype.clear=jr,g.prototype.delete=Tr,g.prototype.get=Ar,g.prototype.has=Ir,g.prototype.set=Mr;var A=g,Pr=A;function Er(){this.__data__=new Pr,this.size=0}var Dr=Er;function Br(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var Lr=Br;function Ur(e){return this.__data__.get(e)}var zr=Ur;function Fr(e){return this.__data__.has(e)}var Gr=Fr,Rr=z,qr=v,kr=Rr(qr,"Map"),ie=kr,Hr=z,Nr=Hr(Object,"create"),I=Nr,ae=I;function Kr(){this.__data__=ae?ae(null):{},this.size=0}var Wr=Kr;function Xr(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var Vr=Xr,Qr=I,Jr="__lodash_hash_undefined__",Yr=Object.prototype,Zr=Yr.hasOwnProperty;function ei(e){var t=this.__data__;if(Qr){var r=t[e];return r===Jr?void 0:r}return Zr.call(t,e)?t[e]:void 0}var ti=ei,ri=I,ii=Object.prototype,ai=ii.hasOwnProperty;function si(e){var t=this.__data__;return ri?t[e]!==void 0:ai.call(t,e)}var ni=si,oi=I,li="__lodash_hash_undefined__";function hi(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=oi&&t===void 0?li:t,this}var ci=hi,ui=Wr,di=Vr,pi=ti,fi=ni,vi=ci;function y(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}y.prototype.clear=ui,y.prototype.delete=di,y.prototype.get=pi,y.prototype.has=fi,y.prototype.set=vi;var gi=y,se=gi,yi=A,bi=ie;function _i(){this.size=0,this.__data__={hash:new se,map:new(bi||yi),string:new se}}var $i=_i;function mi(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var xi=mi,Oi=xi;function Ci(e,t){var r=e.__data__;return Oi(t)?r[typeof t=="string"?"string":"hash"]:r.map}var M=Ci,Si=M;function wi(e){var t=Si(this,e).delete(e);return this.size-=t?1:0,t}var ji=wi,Ti=M;function Ai(e){return Ti(this,e).get(e)}var Ii=Ai,Mi=M;function Pi(e){return Mi(this,e).has(e)}var Ei=Pi,Di=M;function Bi(e,t){var r=Di(this,e),i=r.size;return r.set(e,t),this.size+=r.size==i?0:1,this}var Li=Bi,Ui=$i,zi=ji,Fi=Ii,Gi=Ei,Ri=Li;function b(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}b.prototype.clear=Ui,b.prototype.delete=zi,b.prototype.get=Fi,b.prototype.has=Gi,b.prototype.set=Ri;var qi=b,ki=A,Hi=ie,Ni=qi,Ki=200;function Wi(e,t){var r=this.__data__;if(r instanceof ki){var i=r.__data__;if(!Hi||i.length<Ki-1)return i.push([e,t]),this.size=++r.size,this;r=this.__data__=new Ni(i)}return r.set(e,t),this.size=r.size,this}var Xi=Wi,Vi=A,Qi=Dr,Ji=Lr,Yi=zr,Zi=Gr,ea=Xi;function _(e){var t=this.__data__=new Vi(e);this.size=t.size}_.prototype.clear=Qi,_.prototype.delete=Ji,_.prototype.get=Yi,_.prototype.has=Zi,_.prototype.set=ea;var ta=_,ne=ee;function ra(e,t,r){t=="__proto__"&&ne?ne(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var F=ra,ia=F,aa=j;function sa(e,t,r){(r!==void 0&&!aa(e[t],r)||r===void 0&&!(t in e))&&ia(e,t,r)}var oe=sa;function na(e){return function(t,r,i){for(var s=-1,a=Object(t),n=i(t),o=n.length;o--;){var l=n[e?o:++s];if(r(a[l],l,a)===!1)break}return t}}var oa=na,la=oa,ha=la(),ca=ha,P={exports:{}};P.exports,function(e,t){var r=v,i=t&&!t.nodeType&&t,s=i&&!0&&e&&!e.nodeType&&e,a=s&&s.exports===i,n=a?r.Buffer:void 0,o=n?n.allocUnsafe:void 0;function l(c,u){if(u)return c.slice();var f=c.length,m=o?o(f):new c.constructor(f);return c.copy(m),m}e.exports=l}(P,P.exports);var ua=P.exports,da=v,pa=da.Uint8Array,fa=pa,le=fa;function va(e){var t=new e.constructor(e.byteLength);return new le(t).set(new le(e)),t}var ga=va,ya=ga;function ba(e,t){var r=t?ya(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}var _a=ba;function $a(e,t){var r=-1,i=e.length;for(t||(t=Array(i));++r<i;)t[r]=e[r];return t}var ma=$a,xa=p,he=Object.create,Oa=function(){function e(){}return function(t){if(!xa(t))return{};if(he)return he(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}(),Ca=Oa;function Sa(e,t){return function(r){return e(t(r))}}var wa=Sa,ja=wa,Ta=ja(Object.getPrototypeOf,Object),ce=Ta,Aa=Object.prototype;function Ia(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||Aa;return e===r}var ue=Ia,Ma=Ca,Pa=ce,Ea=ue;function Da(e){return typeof e.constructor=="function"&&!Ea(e)?Ma(Pa(e)):{}}var Ba=Da;function La(e){return e!=null&&typeof e=="object"}var C=La,Ua=w,za=C,Fa="[object Arguments]";function Ga(e){return za(e)&&Ua(e)==Fa}var Ra=Ga,de=Ra,qa=C,pe=Object.prototype,ka=pe.hasOwnProperty,Ha=pe.propertyIsEnumerable,Na=de(function(){return arguments}())?de:function(e){return qa(e)&&ka.call(e,"callee")&&!Ha.call(e,"callee")},fe=Na,Ka=Array.isArray,ve=Ka,Wa=9007199254740991;function Xa(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=Wa}var ge=Xa,Va=L,Qa=ge;function Ja(e){return e!=null&&Qa(e.length)&&!Va(e)}var G=Ja,Ya=G,Za=C;function es(e){return Za(e)&&Ya(e)}var ts=es,E={exports:{}};function rs(){return!1}var is=rs;E.exports,function(e,t){var r=v,i=is,s=t&&!t.nodeType&&t,a=s&&!0&&e&&!e.nodeType&&e,n=a&&a.exports===s,o=n?r.Buffer:void 0,l=o?o.isBuffer:void 0,c=l||i;e.exports=c}(E,E.exports);var ye=E.exports,as=w,ss=ce,ns=C,os="[object Object]",ls=Function.prototype,hs=Object.prototype,be=ls.toString,cs=hs.hasOwnProperty,us=be.call(Object);function ds(e){if(!ns(e)||as(e)!=os)return!1;var t=ss(e);if(t===null)return!0;var r=cs.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&be.call(r)==us}var ps=ds,fs=w,vs=ge,gs=C,ys="[object Arguments]",bs="[object Array]",_s="[object Boolean]",$s="[object Date]",ms="[object Error]",xs="[object Function]",Os="[object Map]",Cs="[object Number]",Ss="[object Object]",ws="[object RegExp]",js="[object Set]",Ts="[object String]",As="[object WeakMap]",Is="[object ArrayBuffer]",Ms="[object DataView]",Ps="[object Float32Array]",Es="[object Float64Array]",Ds="[object Int8Array]",Bs="[object Int16Array]",Ls="[object Int32Array]",Us="[object Uint8Array]",zs="[object Uint8ClampedArray]",Fs="[object Uint16Array]",Gs="[object Uint32Array]",h={};h[Ps]=h[Es]=h[Ds]=h[Bs]=h[Ls]=h[Us]=h[zs]=h[Fs]=h[Gs]=!0,h[ys]=h[bs]=h[Is]=h[_s]=h[Ms]=h[$s]=h[ms]=h[xs]=h[Os]=h[Cs]=h[Ss]=h[ws]=h[js]=h[Ts]=h[As]=!1;function Rs(e){return gs(e)&&vs(e.length)&&!!h[fs(e)]}var qs=Rs;function ks(e){return function(t){return e(t)}}var Hs=ks,D={exports:{}};D.exports,function(e,t){var r=W,i=t&&!t.nodeType&&t,s=i&&!0&&e&&!e.nodeType&&e,a=s&&s.exports===i,n=a&&r.process,o=function(){try{var l=s&&s.require&&s.require("util").types;return l||n&&n.binding&&n.binding("util")}catch{}}();e.exports=o}(D,D.exports);var Ns=D.exports,Ks=qs,Ws=Hs,_e=Ns,$e=_e&&_e.isTypedArray,Xs=$e?Ws($e):Ks,me=Xs;function Vs(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}var xe=Vs,Qs=F,Js=j,Ys=Object.prototype,Zs=Ys.hasOwnProperty;function en(e,t,r){var i=e[t];(!(Zs.call(e,t)&&Js(i,r))||r===void 0&&!(t in e))&&Qs(e,t,r)}var tn=en,rn=tn,an=F;function sn(e,t,r,i){var s=!r;r||(r={});for(var a=-1,n=t.length;++a<n;){var o=t[a],l=i?i(r[o],e[o],o,r,e):void 0;l===void 0&&(l=e[o]),s?an(r,o,l):rn(r,o,l)}return r}var nn=sn;function on(e,t){for(var r=-1,i=Array(e);++r<e;)i[r]=t(r);return i}var ln=on,hn=9007199254740991,cn=/^(?:0|[1-9]\d*)$/;function un(e,t){var r=typeof e;return t=t??hn,!!t&&(r=="number"||r!="symbol"&&cn.test(e))&&e>-1&&e%1==0&&e<t}var Oe=un,dn=ln,pn=fe,fn=ve,vn=ye,gn=Oe,yn=me,bn=Object.prototype,_n=bn.hasOwnProperty;function $n(e,t){var r=fn(e),i=!r&&pn(e),s=!r&&!i&&vn(e),a=!r&&!i&&!s&&yn(e),n=r||i||s||a,o=n?dn(e.length,String):[],l=o.length;for(var c in e)(t||_n.call(e,c))&&!(n&&(c=="length"||s&&(c=="offset"||c=="parent")||a&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||gn(c,l)))&&o.push(c);return o}var mn=$n;function xn(e){var t=[];if(e!=null)for(var r in Object(e))t.push(r);return t}var On=xn,Cn=p,Sn=ue,wn=On,jn=Object.prototype,Tn=jn.hasOwnProperty;function An(e){if(!Cn(e))return wn(e);var t=Sn(e),r=[];for(var i in e)i=="constructor"&&(t||!Tn.call(e,i))||r.push(i);return r}var In=An,Mn=mn,Pn=In,En=G;function Dn(e){return En(e)?Mn(e,!0):Pn(e)}var Ce=Dn,Bn=nn,Ln=Ce;function Un(e){return Bn(e,Ln(e))}var zn=Un,Se=oe,Fn=ua,Gn=_a,Rn=ma,qn=Ba,we=fe,je=ve,kn=ts,Hn=ye,Nn=L,Kn=p,Wn=ps,Xn=me,Te=xe,Vn=zn;function Qn(e,t,r,i,s,a,n){var o=Te(e,r),l=Te(t,r),c=n.get(l);if(c){Se(e,r,c);return}var u=a?a(o,l,r+"",e,t,n):void 0,f=u===void 0;if(f){var m=je(l),k=!m&&Hn(l),Be=!m&&!k&&Xn(l);u=l,m||k||Be?je(o)?u=o:kn(o)?u=Rn(o):k?(f=!1,u=Fn(l,!0)):Be?(f=!1,u=Gn(l,!0)):u=[]:Wn(l)||we(l)?(u=o,we(o)?u=Vn(o):(!Kn(o)||Nn(o))&&(u=qn(l))):f=!1}f&&(n.set(l,u),s(u,l,i,a,n),n.delete(l)),Se(e,r,u)}var Jn=Qn,Yn=ta,Zn=oe,eo=ca,to=Jn,ro=p,io=Ce,ao=xe;function Ae(e,t,r,i,s){e!==t&&eo(t,function(a,n){if(s||(s=new Yn),ro(a))to(e,t,n,r,Ae,i,s);else{var o=i?i(ao(e,n),a,n+"",e,t,s):void 0;o===void 0&&(o=a),Zn(e,n,o)}},io)}var Ie=Ae,so=Ie,Me=p;function Pe(e,t,r,i,s,a){return Me(e)&&Me(t)&&(a.set(t,e),so(e,t,void 0,Pe,a),a.delete(t)),e}var no=Pe,oo=j,lo=G,ho=Oe,co=p;function uo(e,t,r){if(!co(r))return!1;var i=typeof t;return(i=="number"?lo(r)&&ho(t,r.length):i=="string"&&t in r)?oo(r[t],e):!1}var po=uo,fo=re,vo=po;function go(e){return fo(function(t,r){var i=-1,s=r.length,a=s>1?r[s-1]:void 0,n=s>2?r[2]:void 0;for(a=e.length>3&&typeof a=="function"?(s--,a):void 0,n&&vo(r[0],r[1],n)&&(a=s<3?void 0:a,s=1),t=Object(t);++i<s;){var o=r[i];o&&e(t,o,i,a)}return t})}var yo=go,bo=Ie,_o=yo,$o=_o(function(e,t,r,i){bo(e,t,r,i)}),mo=$o,xo=H,Oo=re,Co=no,So=mo,wo=Oo(function(e){return e.push(void 0,Co),xo(So,void 0,e)}),jo=wo;const To=x(jo),Ao={modules:["DisplaySize","Toolbar","Resize"],overlayStyles:{position:"absolute",boxSizing:"border-box",border:"1px dashed #444"},handleStyles:{position:"absolute",height:"12px",width:"12px",backgroundColor:"white",border:"1px solid #777",boxSizing:"border-box",opacity:"0.80"},displayStyles:{position:"absolute",font:"12px/1.0 Arial, Helvetica, sans-serif",padding:"4px 8px",textAlign:"center",backgroundColor:"white",color:"#333",border:"1px solid #777",boxSizing:"border-box",opacity:"0.80",cursor:"default"},toolbarStyles:{position:"absolute",top:"-12px",right:"0",left:"0",height:"0",minWidth:"100px",font:"12px/1.0 Arial, Helvetica, sans-serif",textAlign:"center",color:"#333",boxSizing:"border-box",cursor:"default"},toolbarButtonStyles:{display:"inline-block",width:"24px",height:"24px",background:"white",border:"1px solid #999",verticalAlign:"middle"},toolbarButtonSvgStyles:{fill:"#444",stroke:"#444",strokeWidth:"2"}};class R{constructor(t){this.onCreate=()=>{},this.onDestroy=()=>{},this.onUpdate=()=>{},this.overlay=t.overlay,this.img=t.img,this.options=t.options,this.requestUpdate=t.onUpdate}}class Io extends R{constructor(t){super(t),this.display=null,this.onCreate=()=>{var r;this.display=document.createElement("div"),Object.assign(this.display.style,this.options.displayStyles),(r=this.overlay)==null||r.appendChild(this.display)},this.onDestroy=()=>{},this.onUpdate=()=>{if(!this.display||!this.img)return;const r=this.getCurrentSize();if(this.display.innerHTML=r.join(" &times; "),r[0]>120&&r[1]>30)Object.assign(this.display.style,{right:"4px",bottom:"4px",left:"auto"});else if(this.img.style.float=="right"){const i=this.display.getBoundingClientRect();Object.assign(this.display.style,{right:"auto",bottom:`-${i.height+4}px`,left:`-${i.width+4}px`})}else{const i=this.display.getBoundingClientRect();Object.assign(this.display.style,{right:`-${i.width+4}px`,bottom:`-${i.height+4}px`,left:"auto"})}},this.getCurrentSize=()=>{var r;return[((r=this.img)==null?void 0:r.width)||0,this.img?Math.round(this.img.width/this.img.naturalWidth*this.img.naturalHeight):0]}}}const Mo=`<svg viewbox="0 0 18 18">
  <line class="ql-stroke" x1="3" x2="15" y1="9" y2="9"></line>
  <line class="ql-stroke" x1="3" x2="13" y1="14" y2="14"></line>
  <line class="ql-stroke" x1="3" x2="9" y1="4" y2="4"></line>
</svg>`,Po=`<svg viewbox="0 0 18 18">
  <line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"></line>
  <line class="ql-stroke" x1="14" x2="4" y1="14" y2="14"></line>
  <line class="ql-stroke" x1="12" x2="6" y1="4" y2="4"></line>
</svg>`,Eo=`<svg viewbox="0 0 18 18">
  <line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"></line>
  <line class="ql-stroke" x1="15" x2="5" y1="14" y2="14"></line>
  <line class="ql-stroke" x1="15" x2="9" y1="4" y2="4"></line>
</svg>`,q=window.Quill.imports.parchment,$=new q.StyleAttributor("float","float"),S=new q.StyleAttributor("margin","margin"),B=new q.StyleAttributor("display","display");class Do extends R{constructor(t){super(t),this.alignments=[],this.onCreate=()=>{var r;this.toolbar=document.createElement("div"),Object.assign(this.toolbar.style,this.options.toolbarStyles),(r=this.overlay)==null||r.appendChild(this.toolbar),this._defineAlignments(),this._addToolbarButtons()},this.onDestroy=()=>{},this.onUpdate=()=>{},this._defineAlignments=()=>{this.alignments=[{icon:Mo,apply:()=>{B.add(this.img,"inline"),$.add(this.img,"left"),S.add(this.img,"0 1em 1em 0")},isApplied:()=>$.value(this.img)==="left"},{icon:Po,apply:()=>{B.add(this.img,"block"),$.remove(this.img),S.add(this.img,"auto")},isApplied:()=>S.value(this.img)==="auto"},{icon:Eo,apply:()=>{B.add(this.img,"inline"),$.add(this.img,"right"),S.add(this.img,"0 0 1em 1em")},isApplied:()=>$.value(this.img)==="right"}]},this._addToolbarButtons=()=>{const r=[];this.alignments.forEach((i,s)=>{var n;const a=document.createElement("span");r.push(a),a.innerHTML=i.icon,a.addEventListener("click",()=>{r.forEach(o=>o.style.filter=""),i.isApplied()?($.remove(this.img),S.remove(this.img),B.remove(this.img)):(this._selectButton(a),i.apply()),this.requestUpdate()}),Object.assign(a.style,this.options.toolbarButtonStyles),s>0&&(a.style.borderLeftWidth="0"),Object.assign(a.children[0].style,this.options.toolbarButtonSvgStyles),i.isApplied()&&this._selectButton(a),(n=this.toolbar)==null||n.appendChild(a)})},this._selectButton=r=>{r.style.filter="invert(20%)"}}}class Bo extends R{constructor(t){super(t),this.boxes=[],this.dragBox=null,this.dragStartX=0,this.preDragWidth=0,this.onCreate=()=>{this.boxes=[],this.addBox("nwse-resize"),this.addBox("nesw-resize"),this.addBox("nwse-resize"),this.addBox("nesw-resize"),this.positionBoxes()},this.onDestroy=()=>{this.setCursor("")},this.positionBoxes=()=>{var s,a;const r=`${-parseFloat(((s=this.options.handleStyles)==null?void 0:s.width.toString())||"0")/2}px`,i=`${-parseFloat(((a=this.options.handleStyles)==null?void 0:a.height.toString())||"0")/2}px`;[{left:r,top:i},{right:r,top:i},{right:r,bottom:i},{left:r,bottom:i}].forEach((n,o)=>{Object.assign(this.boxes[o].style,n)})},this.addBox=r=>{var s,a,n;const i=document.createElement("div");Object.assign(i.style,this.options.handleStyles),i.style.cursor=r,i.style.width=`${((s=this.options.handleStyles)==null?void 0:s.width)||0}px`,i.style.height=`${((a=this.options.handleStyles)==null?void 0:a.height)||0}px`,i.addEventListener("mousedown",this.handleMousedown,!1),(n=this.overlay)==null||n.appendChild(i),this.boxes.push(i)},this.handleMousedown=r=>{var i,s;this.dragBox=r.target,this.dragStartX=r.clientX,this.preDragWidth=((i=this.img)==null?void 0:i.width)||((s=this.img)==null?void 0:s.naturalWidth)||0,this.setCursor(this.dragBox.style.cursor),document.addEventListener("mousemove",this.handleDrag,!1),document.addEventListener("mouseup",this.handleMouseup,!1)},this.handleMouseup=()=>{this.setCursor(""),document.removeEventListener("mousemove",this.handleDrag),document.removeEventListener("mouseup",this.handleMouseup)},this.handleDrag=r=>{if(!this.img)return;const i=r.clientX-this.dragStartX;this.dragBox===this.boxes[0]||this.dragBox===this.boxes[3]?this.img.width=Math.round(this.preDragWidth-i):this.img.width=Math.round(this.preDragWidth+i),this.requestUpdate()},this.setCursor=r=>{[document.body,this.img].forEach(s=>{s&&(s.style.cursor=r)})}}}const Lo=Object.freeze(["userSelect","mozUserSelect","webkitUserSelect","msUserSelect"]),Uo={DisplaySize:Io,Toolbar:Do,Resize:Bo};class Ee{constructor(t,r={}){var s;this.moduleClasses=[],this.modules=[],this.onUpdate=()=>{this.repositionElements(),this.modules.forEach(a=>{a.onUpdate()})},this.removeModules=()=>{this.modules.forEach(a=>{a.onDestroy()}),this.modules=[]},this.handleClick=a=>{var o;const n=a.target;if(((o=n==null?void 0:n.tagName)==null?void 0:o.toUpperCase())==="IMG"){if(this.img===n)return;this.img&&this.hide(),this.show(n)}else this.img&&this.hide()},this.show=a=>{this.img=a,this.showOverlay(),this.initializeModules()},this.showOverlay=()=>{this.overlay&&this.hideOverlay(),this.quill.setSelection(null),this.setUserSelect("none"),document.addEventListener("keyup",this.checkImageKeyUp,!0),this.quill.root.addEventListener("input",this.checkImageInput,!0),this.overlay=document.createElement("div"),Object.assign(this.overlay.style,this.options.overlayStyles),this.quill.root.parentNode.appendChild(this.overlay),this.repositionElements()},this.hideOverlay=()=>{this.overlay&&(this.quill.root.parentNode.removeChild(this.overlay),this.overlay=void 0,document.removeEventListener("keyup",this.checkImageKeyUp),this.quill.root.removeEventListener("input",this.checkImageInput),this.setUserSelect(""))},this.repositionElements=()=>{if(!this.overlay||!this.img)return;const a=this.quill.root.parentNode,n=this.img.getBoundingClientRect(),o=a.getBoundingClientRect();Object.assign(this.overlay.style,{left:`${n.left-o.left-1+a.scrollLeft}px`,top:`${n.top-o.top+a.scrollTop}px`,width:`${n.width}px`,height:`${n.height}px`})},this.hide=()=>{this.hideOverlay(),this.removeModules(),this.img=void 0},this.setUserSelect=a=>{Lo.forEach(n=>{this.quill.root.style[n]=a,document.documentElement.style[n]=a})},this.checkImageKeyUp=a=>{var n;this.img&&(["Backspace","Delete"].includes(a.code)&&((n=window.Quill)==null||n.find(this.img).deleteAt(0)),this.hide())},this.checkImageInput=a=>{var n;this.img&&(["deleteContentForward","deleteContentBackward"].includes(a.inputType)&&((n=window.Quill)==null||n.find(this.img).deleteAt(0)),this.hide())},this.initializeModules=this.initializeModules.bind(this),this.quill=t,this.options=To({},r,Ao),(s=r.modules)!=null&&s.length&&(this.moduleClasses=r.modules.slice()),this.quill.root.addEventListener("click",this.handleClick,!1);const i=this.quill.root.parentNode;i.style.position=i.style.position||"relative",this.modules=[],this.moduleClasses=this.options.modules||[]}initializeModules(){var t;this.removeModules(),this.modules=((t=this.moduleClasses)==null?void 0:t.map(r=>new(Uo[r]||r)(this)))||[],this.modules.forEach(r=>{r.onCreate()}),this.onUpdate()}}return(De=window.Quill)==null||De.register("modules/imageResizor",Ee),Ee});
